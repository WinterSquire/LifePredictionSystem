import sys
import os

def cnn(test_data_path: str) -> str:
    # 获取脚本文件的路径
    script_dir = os.path.dirname(os.path.abspath(__file__))
    sys.path.append(script_dir)
    data_folder = os.path.abspath(os.path.join(script_dir, '../data'))

    column_to_delete = [26, 4, 4, 7, 11, 16, 17, 17, 0, 0, 0, 0, 3]

    import data_process
    import model_process

    test_data = data_process.load_data(test_data_path, column_to_delete)
    train_data = data_process.load_data(data_folder + '/train.txt', column_to_delete)

    result = model_process.process(train_data, test_data)

    # result = {"loss": [5767.53759765625, 4925.7353515625, 4935.7578125, 4919.24169921875, 4902.58984375, 4907.87255859375, 4876.0302734375, 4884.578125, 4861.27001953125, 4866.55615234375, 4866.3203125, 4850.2890625, 4842.36279296875, 4838.62158203125, 4842.62353515625, 4826.75927734375, 4837.12158203125, 4814.7802734375, 4819.8671875, 4816.04248046875, 4811.61572265625, 4800.4501953125, 4789.8701171875, 4795.42041015625, 4795.26171875, 4793.6455078125, 4796.783203125, 4794.54248046875, 4766.18994140625, 4782.3046875, 4778.40087890625, 4772.97216796875, 4787.01904296875, 4779.95654296875, 4785.73583984375, 4776.9501953125, 4777.5107421875, 4770.17919921875, 4764.8798828125, 4767.53125, 4768.11279296875, 4768.08203125, 4763.8076171875, 4770.57080078125, 4766.21630859375, 4760.9130859375, 4762.4775390625, 4756.80615234375, 4764.2412109375, 4761.4296875], "mse": [5767.30224609375, 4925.501953125, 4935.5244140625, 4919.00634765625, 4902.35400390625, 4907.64013671875, 4875.798828125, 4884.34912109375, 4861.03662109375, 4866.32666015625, 4866.091796875, 4850.05908203125, 4842.1318359375, 4838.39208984375, 4842.3974609375, 4826.53515625, 4836.8984375, 4814.552734375, 4819.64208984375, 4815.8173828125, 4811.3896484375, 4800.22509765625, 4789.65087890625, 4795.2001953125, 4795.0390625, 4793.42822265625, 4796.5673828125, 4794.32568359375, 4765.96875, 4782.083984375, 4778.18115234375, 4772.75927734375, 4786.798828125, 4779.73828125, 4785.5185546875, 4776.7373046875, 4777.29638671875, 4769.9638671875, 4764.66845703125,4767.31982421875, 4767.8955078125, 4767.8681640625, 4763.5947265625, 4770.35888671875, 4766.005859375, 4760.7060546875, 4762.26806640625, 4756.59716796875, 4764.03173828125, 4761.2236328125], "val_loss": [4703.1298828125, 4680.923828125, 4710.576171875, 4707.58544921875, 4596.5810546875, 4698.9404296875, 4695.67919921875, 4728.97607421875, 4757.24169921875, 4717.0517578125, 4704.0625, 4607.88037109375, 4688.36279296875, 4705.560546875, 4699.9853515625, 4641.62109375, 4687.58056640625, 4661.00048828125, 4671.595703125, 4619.728515625, 4698.0107421875, 4563.57568359375, 4603.14306640625, 4684.86328125,4706.8798828125, 4605.78173828125, 4677.1162109375, 4606.83447265625, 4651.1572265625, 4702.39111328125, 4661.5751953125, 4649.1572265625, 4717.22705078125, 4695.68994140625, 4614.20458984375, 4637.9462890625, 4746.15234375, 4544.16064453125, 4566.31787109375, 4625.15380859375, 4723.640625, 4594.14208984375, 4622.1015625, 4705.07373046875, 4653.04248046875, 4645.47021484375, 4634.7431640625, 4616.810546875, 4642.59033203125, 4584.96923828125], "val_mse": [4702.89599609375, 4680.68896484375, 4710.33837890625, 4707.3515625, 4596.349609375, 4698.7060546875, 4695.447265625, 4728.7451171875, 4757.01025390625, 4716.82275390625, 4703.8330078125, 4607.6513671875, 4688.13232421875, 4705.33154296875, 4699.759765625, 4641.39404296875, 4687.353515625, 4660.77294921875, 4671.36962890625, 4619.50439453125, 4697.7841796875, 4563.35107421875, 4602.923828125, 4684.64404296875, 4706.65869140625, 4605.56201171875, 4676.8955078125, 4606.61279296875, 4650.93408203125, 4702.1767578125, 4661.35888671875, 4648.94091796875, 4717.01025390625, 4695.4765625, 4613.99072265625, 4637.728515625, 4745.93505859375, 4543.94677734375, 4566.109375, 4624.939453125, 4723.42724609375, 4593.93017578125, 4621.8896484375, 4704.8623046875,4652.83642578125, 4645.25732421875, 4634.53271484375, 4616.6025390625, 4642.38134765625, 4584.76318359375], "mean_mse": 67.71087055318843, "total_score": 1420172288.0}

    return str(result).replace('\'', '\"')
